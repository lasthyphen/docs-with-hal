(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3080],{23703:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/guides/getting-started/tutorials/dynamic-fee-js",function(){return o(27517)}])},27517:function(e,t,o){"use strict";o.r(t),o.d(t,{CH:function(){return a},Page:function(){return p},chCodeConfig:function(){return l},meta:function(){return i}});var n=o(52322),r=o(3905),s=o(65854),c=o(72499),a={annotations:s.ds,Code:s.EK},l={staticMediaQuery:"not screen, (max-width: 768px)",theme:{name:"supabase",type:"from-css",tokenColors:[{scope:["comment","punctuation.definition.comment","string.comment"],settings:{foreground:"var(--ch-1)"}},{scope:["constant","entity.name.constant","variable.other.constant","variable.other.enummember","variable.language","entity"],settings:{foreground:"var(--ch-2)"}},{scope:["entity.name","meta.export.default","meta.definition.variable"],settings:{foreground:"var(--ch-3)"}},{scope:["variable.parameter.function","meta.jsx.children","meta.block","meta.tag.attributes","entity.name.constant","meta.object.member","meta.embedded.expression"],settings:{foreground:"var(--ch-4)"}},{scope:"entity.name.function",settings:{foreground:"var(--ch-5)"}},{scope:["entity.name.tag","support.class.component"],settings:{foreground:"var(--ch-6)"}},{scope:"keyword",settings:{foreground:"var(--ch-7)"}},{scope:["storage","storage.type"],settings:{foreground:"var(--ch-7)"}},{scope:["storage.modifier.package","storage.modifier.import","storage.type.java"],settings:{foreground:"var(--ch-4)"}},{scope:["string","string punctuation.section.embedded source"],settings:{foreground:"var(--ch-8)"}},{scope:"support",settings:{foreground:"var(--ch-2)"}},{scope:"meta.property-name",settings:{foreground:"var(--ch-2)"}},{scope:"variable",settings:{foreground:"var(--ch-3)"}},{scope:"variable.other",settings:{foreground:"var(--ch-4)"}},{scope:"invalid.broken",settings:{foreground:"var(--ch-9)",fontStyle:"italic"}},{scope:"invalid.deprecated",settings:{foreground:"var(--ch-9)",fontStyle:"italic"}},{scope:"invalid.illegal",settings:{foreground:"var(--ch-9)",fontStyle:"italic"}},{scope:"invalid.unimplemented",settings:{foreground:"var(--ch-9)",fontStyle:"italic"}},{scope:"carriage-return",settings:{background:"var(--ch-7)",foreground:"var(--ch-10)",fontStyle:"italic underline"}},{scope:"message.error",settings:{foreground:"var(--ch-9)"}},{scope:"string variable",settings:{foreground:"var(--ch-2)"}},{scope:["source.regexp","string.regexp"],settings:{foreground:"var(--ch-8)"}},{scope:["string.regexp.character-class","string.regexp constant.character.escape","string.regexp source.ruby.embedded","string.regexp string.regexp.arbitrary-repitition"],settings:{foreground:"var(--ch-8)"}},{scope:"string.regexp constant.character.escape",settings:{foreground:"var(--ch-6)",fontStyle:"bold"}},{scope:"support.constant",settings:{foreground:"var(--ch-2)"}},{scope:"support.variable",settings:{foreground:"var(--ch-2)"}},{scope:"support.type.property-name.json",settings:{foreground:"var(--ch-6)"}},{scope:"meta.module-reference",settings:{foreground:"var(--ch-2)"}},{scope:"punctuation.definition.list.begin.markdown",settings:{foreground:"var(--ch-3)"}},{scope:["markup.heading","markup.heading entity.name"],settings:{foreground:"var(--ch-2)",fontStyle:"bold"}},{scope:"markup.quote",settings:{foreground:"var(--ch-6)"}},{scope:"markup.italic",settings:{foreground:"var(--ch-4)",fontStyle:"italic"}},{scope:"markup.bold",settings:{foreground:"var(--ch-4)",fontStyle:"bold"}},{scope:["markup.underline"],settings:{fontStyle:"underline"}},{scope:["markup.strikethrough"],settings:{fontStyle:"strikethrough"}},{scope:"markup.inline.raw",settings:{foreground:"var(--ch-2)"}},{scope:["markup.deleted","meta.diff.header.from-file","punctuation.definition.deleted"],settings:{background:"var(--ch-11)",foreground:"var(--ch-9)"}},{scope:["punctuation.section.embedded"],settings:{foreground:"var(--ch-7)"}},{scope:["markup.inserted","meta.diff.header.to-file","punctuation.definition.inserted"],settings:{background:"var(--ch-12)",foreground:"var(--ch-6)"}},{scope:["markup.changed","punctuation.definition.changed"],settings:{background:"var(--ch-13)",foreground:"var(--ch-3)"}},{scope:["markup.ignored","markup.untracked"],settings:{background:"var(--ch-2)",foreground:"var(--ch-14)"}},{scope:"meta.diff.range",settings:{foreground:"var(--ch-5)",fontStyle:"bold"}},{scope:"meta.diff.header",settings:{foreground:"var(--ch-2)"}},{scope:"meta.separator",settings:{foreground:"var(--ch-2)",fontStyle:"bold"}},{scope:"meta.output",settings:{foreground:"var(--ch-2)"}},{scope:["brackethighlighter.tag","brackethighlighter.curly","brackethighlighter.round","brackethighlighter.square","brackethighlighter.angle","brackethighlighter.quote"],settings:{foreground:"var(--ch-15)"}},{scope:"brackethighlighter.unmatched",settings:{foreground:"var(--ch-9)"}},{scope:["constant.other.reference.link","string.other.link"],settings:{foreground:"var(--ch-8)",fontStyle:"underline"}}],colors:{"editor.background":"var(--ch-16)","editor.foreground":"var(--ch-4)","editor.selectionBackground":"var(--ch-17)","editor.infoForeground":"var(--ch-18)","editor.rangeHighlightBackground":"var(--ch-19)","editorLineNumber.foreground":"var(--ch-20)","tab.activeBackground":"var(--ch-16)","tab.inactiveBackground":"var(--ch-21)","tab.activeForeground":"var(--ch-4)","tab.inactiveForeground":"var(--ch-15)","tab.border":"var(--ch-22)","tab.activeBorder":"var(--ch-16)","tab.activeBorderTop":"var(--ch-23)","tab.hoverBackground":"var(--ch-16)","tab.hoverForeground":"var(--ch-15)","editorGroupHeader.tabsBorder":"var(--ch-22)","editorGroupHeader.tabsBackground":"var(--ch-21)","list.inactiveSelectionBackground":"var(--ch-24)","list.inactiveSelectionForeground":"var(--ch-4)","list.hoverBackground":"var(--ch-25)","list.hoverForeground":"var(--ch-4)"}},lineNumbers:!0,showCopyButton:!0,autoImport:!0,skipLanguages:[],filepath:"/Users/saleemfareed/Documents/hal-docs/apps/docs/pages/guides/getting-started/tutorials/dynamic-fee-js.mdx"},i={id:"dynamic-fee-js",title:"Sending adjustable fee transactions with DijetsJS",description:"Learn how to send transactions with dynamic fees using DijetsJS",sidebar_label:"DijetsJS & Dynamic Fees"},p=function(e){var t=e.children;return(0,n.jsx)(c.Z,{meta:i,children:t})},h=p;function d(e){var t=Object.assign({h2:"h2",p:"p",a:"a",ul:"ul",li:"li",code:"code",strong:"strong",h3:"h3",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td"},(0,r.ah)(),e.components);return a||v("CH",!1),a.Code||v("CH.Code",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,n.jsxs)(t.p,{children:["The objective of this document is to provide and explain sending transactions\nwith dynamic fees using JavaScript. Make sure you have followed ",(0,n.jsx)(t.a,{href:"dynamic-gas-fee#adjusting-gas-fees-before-submitting-the-transaction",children:"the tutorial on\nadjusting the dynamic fees using\nMetaMask"}),". There, we have\nexplained the key concepts related to dynamic fees and EIP1559 type of\ntransactions."]}),"\n",(0,n.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["Basic familiarity with ",(0,n.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript",children:"JavaScript"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:["Basic familiarity with ",(0,n.jsx)(t.a,{href:"https://nodejs.org/en",children:"Node.js"})," and ",(0,n.jsx)(t.a,{href:"https://www.npmjs.com/",children:"npm"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:["Basic familiarity with ",(0,n.jsx)(t.a,{href:"../introduction",children:"Dijets and its Ternary Chains"})]}),"\n",(0,n.jsxs)(t.li,{children:["Basic understanding of ",(0,n.jsx)(t.a,{href:"dynamic-gas-fee#keywords-and-concepts",children:"dynamic fee transactions"})]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"installing-dependencies",children:"Installing Dependencies"}),"\n",(0,n.jsx)(t.p,{children:"Open the terminal and install the following dependencies in a new folder."}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Ethers"}),"\n",(0,n.jsx)(t.li,{children:"dijets"}),"\n",(0,n.jsx)(t.li,{children:"dotenv"}),"\n"]}),"\n",(0,n.jsx)(a.Code,{codeConfig:l,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"npm install ethers dijets dotenv",props:{}}]}],lang:"text"},annotations:[]}]}),"\n",(0,n.jsx)(t.h2,{id:"setting-up-environment-and-project",children:"Setting up Environment and Project"}),"\n",(0,n.jsxs)(t.p,{children:["To send a transaction we need to sign it using our private key. But private key\nshould not be hard coded in the code, rather must be fetched through some\nenvironment variables. Make a ",(0,n.jsx)(t.code,{children:".env"})," file in the root folder with the following\ncontent."]}),"\n",(0,n.jsx)(a.Code,{codeConfig:l,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"PRIVATEKEY=<TYPE_YOUR_PRIVATE_KEY_HERE>",props:{}}]}],lang:"text"},annotations:[]}]}),"\n",(0,n.jsxs)(t.p,{children:["Now make a new file named ",(0,n.jsx)(t.code,{children:"app.js"})," in the root folder, which will be our main and only\nfile with the ",(0,n.jsx)(t.code,{children:"sendDjtx()"})," function. Follow the rest of the tutorial by\nunderstanding and pasting the provided snippets sequentially in the ",(0,n.jsx)(t.code,{children:"app.js"}),"\nfile."]}),"\n",(0,n.jsx)(t.h2,{id:"importing-dependencies-and-private-key",children:"Importing Dependencies and Private Key"}),"\n",(0,n.jsx)(a.Code,{codeConfig:l,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"const ",props:{style:{color:"var(--ch-7)"}}},{content:"ethers ",props:{style:{color:"var(--ch-2)"}}},{content:"= ",props:{style:{color:"var(--ch-7)"}}},{content:"require",props:{style:{color:"var(--ch-5)"}}},{content:"(",props:{style:{color:"var(--ch-4)"}}},{content:'"ethers"',props:{style:{color:"var(--ch-8)"}}},{content:")",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"const ",props:{style:{color:"var(--ch-7)"}}},{content:"Dijets ",props:{style:{color:"var(--ch-2)"}}},{content:"= ",props:{style:{color:"var(--ch-7)"}}},{content:"require",props:{style:{color:"var(--ch-5)"}}},{content:"(",props:{style:{color:"var(--ch-4)"}}},{content:'"dijets"',props:{style:{color:"var(--ch-8)"}}},{content:").Dijets",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"require",props:{style:{color:"var(--ch-5)"}}},{content:"(",props:{style:{color:"var(--ch-4)"}}},{content:'"dotenv"',props:{style:{color:"var(--ch-8)"}}},{content:").",props:{style:{color:"var(--ch-4)"}}},{content:"config",props:{style:{color:"var(--ch-5)"}}},{content:"()",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"const ",props:{style:{color:"var(--ch-7)"}}},{content:"privateKey ",props:{style:{color:"var(--ch-2)"}}},{content:"=",props:{style:{color:"var(--ch-7)"}}},{content:" process.env.",props:{style:{color:"var(--ch-4)"}}},{content:"PRIVATEKEY",props:{style:{color:"var(--ch-2)"}}}]}],lang:"js"},annotations:[]}]}),"\n",(0,n.jsx)(t.h2,{id:"setting-up-http-provider-connected-with-dijets-testnet-network",children:"Setting up HTTP Provider Connected with Dijets TestNet Network"}),"\n",(0,n.jsxs)(t.p,{children:["Using the HTTP provider, we will connect to one of the nodes on the Dijets TestNet\nnetwork. Using this provider we will send the signed transaction to the network.\nYou can also connect to Mainnet using the URL -\n",(0,n.jsx)(t.code,{children:"https://dijets.ukwest.cloudapp.azure.com:443/ext/bc/C/rpc"})]}),"\n",(0,n.jsx)(a.Code,{codeConfig:l,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"// For sending a signed transaction to the network",props:{style:{color:"var(--ch-1)"}}}]},{tokens:[{content:"const ",props:{style:{color:"var(--ch-7)"}}},{content:"nodeURL ",props:{style:{color:"var(--ch-2)"}}},{content:"= ",props:{style:{color:"var(--ch-7)"}}},{content:'"https://dijets.ukwest.cloudapp.azure.com:443/ext/bc/C/rpc"',props:{style:{color:"var(--ch-8)"}}}]},{tokens:[{content:"const ",props:{style:{color:"var(--ch-7)"}}},{content:"HTTPSProvider ",props:{style:{color:"var(--ch-2)"}}},{content:"= new",props:{style:{color:"var(--ch-7)"}}},{content:" ethers.providers.",props:{style:{color:"var(--ch-4)"}}},{content:"JsonRpcProvider",props:{style:{color:"var(--ch-5)"}}},{content:"(nodeURL)",props:{style:{color:"var(--ch-4)"}}}]}],lang:"javascript"},annotations:[]}]}),"\n",(0,n.jsx)(t.h2,{id:"setting-up-utility-chain-apis-for-estimating-base-and-priority-fees",children:"Setting up Utility Chain APIs for Estimating Base and Priority Fees"}),"\n",(0,n.jsx)(t.p,{children:"To estimate the max fee and max priority fee on the network, we will be using\nUtility Chain APIs. We can use the Utility Chain through a DijetsJS instance connected\nto the network as shown below."}),"\n",(0,n.jsx)(a.Code,{codeConfig:l,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"// For estimating max fee and priority fee using CChain APIs",props:{style:{color:"var(--ch-1)"}}}]},{tokens:[{content:"const ",props:{style:{color:"var(--ch-7)"}}},{content:"chainId ",props:{style:{color:"var(--ch-2)"}}},{content:"= ",props:{style:{color:"var(--ch-7)"}}},{content:"98200",props:{style:{color:"var(--ch-2)"}}}]},{tokens:[{content:"const ",props:{style:{color:"var(--ch-7)"}}},{content:"dijets ",props:{style:{color:"var(--ch-2)"}}},{content:"= new ",props:{style:{color:"var(--ch-7)"}}},{content:"Dijets",props:{style:{color:"var(--ch-5)"}}},{content:"(",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:'  "dijets.ukwest.cloudapp.azure.com:443"',props:{style:{color:"var(--ch-8)"}}},{content:",",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  undefined",props:{style:{color:"var(--ch-2)"}}},{content:",",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:'  "https"',props:{style:{color:"var(--ch-8)"}}},{content:",",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  chainId",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:")",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"const ",props:{style:{color:"var(--ch-7)"}}},{content:"uchain ",props:{style:{color:"var(--ch-2)"}}},{content:"=",props:{style:{color:"var(--ch-7)"}}},{content:" dijets.",props:{style:{color:"var(--ch-4)"}}},{content:"UChain",props:{style:{color:"var(--ch-5)"}}},{content:"()",props:{style:{color:"var(--ch-4)"}}}]}],lang:"javascript"},annotations:[]}]}),"\n",(0,n.jsx)(t.h2,{id:"setting-up-wallet",children:"Setting up Wallet"}),"\n",(0,n.jsx)(t.p,{children:"A wallet is required for signing transactions with your private key and thus making it valid."}),"\n",(0,n.jsx)(a.Code,{codeConfig:l,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"// For signing an unsigned transaction",props:{style:{color:"var(--ch-1)"}}}]},{tokens:[{content:"const ",props:{style:{color:"var(--ch-7)"}}},{content:"wallet ",props:{style:{color:"var(--ch-2)"}}},{content:"= new",props:{style:{color:"var(--ch-7)"}}},{content:" ethers.",props:{style:{color:"var(--ch-4)"}}},{content:"Wallet",props:{style:{color:"var(--ch-5)"}}},{content:"(privateKey)",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"const ",props:{style:{color:"var(--ch-7)"}}},{content:"address ",props:{style:{color:"var(--ch-2)"}}},{content:"=",props:{style:{color:"var(--ch-7)"}}},{content:" wallet.address",props:{style:{color:"var(--ch-4)"}}}]}],lang:"javascript"},annotations:[]}]}),"\n",(0,n.jsx)(t.h2,{id:"function-for-estimating-max-fee-and-max-priority-fee",children:"Function for Estimating Max Fee and Max Priority Fee"}),"\n",(0,n.jsxs)(t.p,{children:["The function ",(0,n.jsx)(t.code,{children:"calcFeeData()"})," estimates the max fee and max priority fee per gas\naccording to network activity using the Utility Chain APIs. This function returns max\nfee and max priority fee per gas in units of ",(0,n.jsx)(t.code,{children:"nDJTX"})," or ",(0,n.jsx)(t.code,{children:"gwei"})," (1 DJTX = 10^9\ngwei)."]}),"\n",(0,n.jsx)(a.Code,{codeConfig:l,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"// Function to estimate max fee and max priority fee",props:{style:{color:"var(--ch-1)"}}}]},{tokens:[{content:"const ",props:{style:{color:"var(--ch-7)"}}},{content:"calcFeeData ",props:{style:{color:"var(--ch-5)"}}},{content:"= async",props:{style:{color:"var(--ch-7)"}}},{content:" (",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  maxFeePerGas ",props:{style:{color:"var(--ch-4)"}}},{content:"= ",props:{style:{color:"var(--ch-7)"}}},{content:"undefined",props:{style:{color:"var(--ch-2)"}}},{content:",",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  maxPriorityFeePerGas ",props:{style:{color:"var(--ch-4)"}}},{content:"= ",props:{style:{color:"var(--ch-7)"}}},{content:"undefined",props:{style:{color:"var(--ch-2)"}}}]},{tokens:[{content:") ",props:{style:{color:"var(--ch-4)"}}},{content:"=>",props:{style:{color:"var(--ch-7)"}}},{content:" {",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  const ",props:{style:{color:"var(--ch-7)"}}},{content:"baseFee ",props:{style:{color:"var(--ch-2)"}}},{content:"= ",props:{style:{color:"var(--ch-7)"}}},{content:"parseInt",props:{style:{color:"var(--ch-5)"}}},{content:"(",props:{style:{color:"var(--ch-4)"}}},{content:"await",props:{style:{color:"var(--ch-7)"}}},{content:" cchain.",props:{style:{color:"var(--ch-4)"}}},{content:"getBaseFee",props:{style:{color:"var(--ch-5)"}}},{content:"(), ",props:{style:{color:"var(--ch-4)"}}},{content:"16",props:{style:{color:"var(--ch-2)"}}},{content:") ",props:{style:{color:"var(--ch-4)"}}},{content:"/ ",props:{style:{color:"var(--ch-7)"}}},{content:"1e9",props:{style:{color:"var(--ch-2)"}}}]},{tokens:[{content:"  maxPriorityFeePerGas ",props:{style:{color:"var(--ch-4)"}}},{content:"=",props:{style:{color:"var(--ch-7)"}}}]},{tokens:[{content:"    maxPriorityFeePerGas ",props:{style:{color:"var(--ch-4)"}}},{content:"== ",props:{style:{color:"var(--ch-7)"}}},{content:"undefined",props:{style:{color:"var(--ch-2)"}}}]},{tokens:[{content:"      ? ",props:{style:{color:"var(--ch-7)"}}},{content:"parseInt",props:{style:{color:"var(--ch-5)"}}},{content:"(",props:{style:{color:"var(--ch-4)"}}},{content:"await",props:{style:{color:"var(--ch-7)"}}},{content:" cchain.",props:{style:{color:"var(--ch-4)"}}},{content:"getMaxPriorityFeePerGas",props:{style:{color:"var(--ch-5)"}}},{content:"(), ",props:{style:{color:"var(--ch-4)"}}},{content:"16",props:{style:{color:"var(--ch-2)"}}},{content:") ",props:{style:{color:"var(--ch-4)"}}},{content:"/ ",props:{style:{color:"var(--ch-7)"}}},{content:"1e9",props:{style:{color:"var(--ch-2)"}}}]},{tokens:[{content:"      :",props:{style:{color:"var(--ch-7)"}}},{content:" maxPriorityFeePerGas",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  maxFeePerGas ",props:{style:{color:"var(--ch-4)"}}},{content:"=",props:{style:{color:"var(--ch-7)"}}}]},{tokens:[{content:"    maxFeePerGas ",props:{style:{color:"var(--ch-4)"}}},{content:"== ",props:{style:{color:"var(--ch-7)"}}},{content:"undefined ",props:{style:{color:"var(--ch-2)"}}},{content:"?",props:{style:{color:"var(--ch-7)"}}},{content:" baseFee ",props:{style:{color:"var(--ch-4)"}}},{content:"+",props:{style:{color:"var(--ch-7)"}}},{content:" maxPriorityFeePerGas ",props:{style:{color:"var(--ch-4)"}}},{content:":",props:{style:{color:"var(--ch-7)"}}},{content:" maxFeePerGas",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  if",props:{style:{color:"var(--ch-7)"}}},{content:" (maxFeePerGas ",props:{style:{color:"var(--ch-4)"}}},{content:"<",props:{style:{color:"var(--ch-7)"}}},{content:" maxPriorityFeePerGas) {",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"    throw ",props:{style:{color:"var(--ch-7)"}}},{content:'"Error: Max fee per gas cannot be less than the max priority fee per gas"',props:{style:{color:"var(--ch-8)"}}}]},{tokens:[{content:"  }",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  return",props:{style:{color:"var(--ch-7)"}}},{content:" {",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"    maxFeePerGas: maxFeePerGas.",props:{style:{color:"var(--ch-4)"}}},{content:"toString",props:{style:{color:"var(--ch-5)"}}},{content:"(),",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"    maxPriorityFeePerGas: maxPriorityFeePerGas.",props:{style:{color:"var(--ch-4)"}}},{content:"toString",props:{style:{color:"var(--ch-5)"}}},{content:"(),",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  }",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"}",props:{style:{color:"var(--ch-4)"}}}]}],lang:"javascript"},annotations:[]}]}),"\n",(0,n.jsx)(t.h2,{id:"function-to-create-sign-and-send-transaction",children:"Function to Create, Sign and Send Transaction"}),"\n",(0,n.jsxs)(t.p,{children:["The function ",(0,n.jsx)(t.code,{children:"sendDjtx()"})," takes 4 arguments -"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"amount"})," - Amount of DJTX to send in the transaction"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"address"})," - Destination address to which we want to send DJTX"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"maxFeePerGas"})," - Desired maximum fee per gas you want to pay in nDJTX"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"maxPriorityFeePerGas"})," - Desired maximum priority fee per gas you want to pay in nDJTX"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"nonce"})," - Used as a differentiator for more than 1 transaction with same signer"]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["The last 3 arguments are optional, and if ",(0,n.jsx)(t.code,{children:"undefined"})," is passed, then it will\nuse the ",(0,n.jsx)(t.code,{children:"calcFeeData()"})," function to estimate them. Each transaction with the\nsame data and parameters is differentiated by a nonce value. If there are more\nthan 1 transactions with the same nonce signed by the same address, then only 1\nof them with the highest effective priority fee will be accepted."]}),"\n",(0,n.jsxs)(t.p,{children:["Note that the ",(0,n.jsx)(t.code,{children:"nonce"}),"\nparameter should only be used when you are either re-issuing or cancelling a\nstuck transaction."]}),"\n",(0,n.jsx)(a.Code,{codeConfig:l,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"// Function to send DJTX",props:{style:{color:"var(--ch-1)"}}}]},{tokens:[{content:"const ",props:{style:{color:"var(--ch-7)"}}},{content:"sendDjtx ",props:{style:{color:"var(--ch-5)"}}},{content:"= async",props:{style:{color:"var(--ch-7)"}}},{content:" (",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  amount",props:{style:{color:"var(--ch-3)"}}},{content:",",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  to",props:{style:{color:"var(--ch-3)"}}},{content:",",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  maxFeePerGas ",props:{style:{color:"var(--ch-4)"}}},{content:"= ",props:{style:{color:"var(--ch-7)"}}},{content:"undefined",props:{style:{color:"var(--ch-2)"}}},{content:",",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  maxPriorityFeePerGas ",props:{style:{color:"var(--ch-4)"}}},{content:"= ",props:{style:{color:"var(--ch-7)"}}},{content:"undefined",props:{style:{color:"var(--ch-2)"}}},{content:",",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  nonce ",props:{style:{color:"var(--ch-4)"}}},{content:"= ",props:{style:{color:"var(--ch-7)"}}},{content:"undefined",props:{style:{color:"var(--ch-2)"}}}]},{tokens:[{content:") ",props:{style:{color:"var(--ch-4)"}}},{content:"=>",props:{style:{color:"var(--ch-7)"}}},{content:" {",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  if",props:{style:{color:"var(--ch-7)"}}},{content:" (nonce ",props:{style:{color:"var(--ch-4)"}}},{content:"== ",props:{style:{color:"var(--ch-7)"}}},{content:"undefined",props:{style:{color:"var(--ch-2)"}}},{content:") {",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"    nonce ",props:{style:{color:"var(--ch-4)"}}},{content:"= await",props:{style:{color:"var(--ch-7)"}}},{content:" HTTPSProvider.",props:{style:{color:"var(--ch-4)"}}},{content:"getTransactionCount",props:{style:{color:"var(--ch-5)"}}},{content:"(address)",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  }",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  // If the max fee or max priority fee is not provided, then it will automatically calculate using Utility Chain APIs",props:{style:{color:"var(--ch-1)"}}}]},{tokens:[{content:"  ;({ maxFeePerGas, maxPriorityFeePerGas } ",props:{style:{color:"var(--ch-4)"}}},{content:"= await ",props:{style:{color:"var(--ch-7)"}}},{content:"calcFeeData",props:{style:{color:"var(--ch-5)"}}},{content:"(",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"    maxFeePerGas,",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"    maxPriorityFeePerGas",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  ))",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  maxFeePerGas ",props:{style:{color:"var(--ch-4)"}}},{content:"=",props:{style:{color:"var(--ch-7)"}}},{content:" ethers.utils.",props:{style:{color:"var(--ch-4)"}}},{content:"parseUnits",props:{style:{color:"var(--ch-5)"}}},{content:"(maxFeePerGas, ",props:{style:{color:"var(--ch-4)"}}},{content:'"gwei"',props:{style:{color:"var(--ch-8)"}}},{content:")",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  maxPriorityFeePerGas ",props:{style:{color:"var(--ch-4)"}}},{content:"=",props:{style:{color:"var(--ch-7)"}}},{content:" ethers.utils.",props:{style:{color:"var(--ch-4)"}}},{content:"parseUnits",props:{style:{color:"var(--ch-5)"}}},{content:"(maxPriorityFeePerGas, ",props:{style:{color:"var(--ch-4)"}}},{content:'"gwei"',props:{style:{color:"var(--ch-8)"}}},{content:")",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  // Type 2 transaction is for EIP1559",props:{style:{color:"var(--ch-1)"}}}]},{tokens:[{content:"  const ",props:{style:{color:"var(--ch-7)"}}},{content:"tx ",props:{style:{color:"var(--ch-2)"}}},{content:"=",props:{style:{color:"var(--ch-7)"}}},{content:" {",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"    type: ",props:{style:{color:"var(--ch-4)"}}},{content:"2",props:{style:{color:"var(--ch-2)"}}},{content:",",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"    nonce,",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"    to,",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"    maxPriorityFeePerGas,",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"    maxFeePerGas,",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"    value: ethers.utils.",props:{style:{color:"var(--ch-4)"}}},{content:"parseEther",props:{style:{color:"var(--ch-5)"}}},{content:"(amount),",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"    chainId,",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  }",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  tx.gasLimit ",props:{style:{color:"var(--ch-4)"}}},{content:"= await",props:{style:{color:"var(--ch-7)"}}},{content:" HTTPSProvider.",props:{style:{color:"var(--ch-4)"}}},{content:"estimateGas",props:{style:{color:"var(--ch-5)"}}},{content:"(tx)",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  const ",props:{style:{color:"var(--ch-7)"}}},{content:"signedTx ",props:{style:{color:"var(--ch-2)"}}},{content:"= await",props:{style:{color:"var(--ch-7)"}}},{content:" wallet.",props:{style:{color:"var(--ch-4)"}}},{content:"signTransaction",props:{style:{color:"var(--ch-5)"}}},{content:"(tx)",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  const ",props:{style:{color:"var(--ch-7)"}}},{content:"txHash ",props:{style:{color:"var(--ch-2)"}}},{content:"=",props:{style:{color:"var(--ch-7)"}}},{content:" ethers.utils.",props:{style:{color:"var(--ch-4)"}}},{content:"keccak256",props:{style:{color:"var(--ch-5)"}}},{content:"(signedTx)",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  console.",props:{style:{color:"var(--ch-4)"}}},{content:"log",props:{style:{color:"var(--ch-5)"}}},{content:"(",props:{style:{color:"var(--ch-4)"}}},{content:'"Sending signed transaction"',props:{style:{color:"var(--ch-8)"}}},{content:")",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  // Sending a signed transaction and waiting for its inclusion",props:{style:{color:"var(--ch-1)"}}}]},{tokens:[{content:"  await",props:{style:{color:"var(--ch-7)"}}},{content:" (",props:{style:{color:"var(--ch-4)"}}},{content:"await",props:{style:{color:"var(--ch-7)"}}},{content:" HTTPSProvider.",props:{style:{color:"var(--ch-4)"}}},{content:"sendTransaction",props:{style:{color:"var(--ch-5)"}}},{content:"(signedTx)).",props:{style:{color:"var(--ch-4)"}}},{content:"wait",props:{style:{color:"var(--ch-5)"}}},{content:"()",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"  console.",props:{style:{color:"var(--ch-4)"}}},{content:"log",props:{style:{color:"var(--ch-5)"}}},{content:"(",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"    `View transaction with nonce ${",props:{style:{color:"var(--ch-8)"}}},{content:"nonce",props:{style:{color:"var(--ch-4)"}}},{content:"}: https://utility-explorer.swedencentral.cloudapp.azure.com/tx/${",props:{style:{color:"var(--ch-8)"}}},{content:"txHash",props:{style:{color:"var(--ch-4)"}}},{content:"}`",props:{style:{color:"var(--ch-8)"}}}]},{tokens:[{content:"  )",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"}",props:{style:{color:"var(--ch-4)"}}}]}],lang:"javascript"},annotations:[]}]}),"\n",(0,n.jsx)(t.p,{children:"This function calculates transaction hash from the signed transaction and logs\non the console, the URL for transaction status on Dijets Utility Chain explorer."}),"\n",(0,n.jsxs)(t.h2,{id:"calling-the-senddjtx-function",children:["Calling the ",(0,n.jsx)(t.code,{children:"sendDJTX()"})," Function"]}),"\n",(0,n.jsx)(t.p,{children:"There are various ways to call this function. We may or may not pass the\noptional arguments like max fee and max priority fee. It is recommended to set\nthe max fee as the maximum price per gas that you are willing to pay for a\ntransaction, no matter how high or low the base fee will be, as at max you will\nonly be charged the provided max fee, along with a small priority fee above the\nbase fee."}),"\n",(0,n.jsx)(t.p,{children:"If you do not pass these arguments, then it will automatically estimate the max\nfee and priority fee from the network. For example, let's say, Bob want to pay 100\nnDJTX per gas for a transaction and a small tip of 2 nDJTX, then Bob will call\nthe following function."}),"\n",(0,n.jsx)(a.Code,{codeConfig:l,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"// setting max fee as 100 and priority fee as 2",props:{style:{color:"var(--ch-1)"}}}]},{tokens:[{content:"sendDjtx",props:{style:{color:"var(--ch-5)"}}},{content:"(",props:{style:{color:"var(--ch-4)"}}},{content:'"0.01"',props:{style:{color:"var(--ch-8)"}}},{content:", ",props:{style:{color:"var(--ch-4)"}}},{content:'"0x8db97C7cEcE249c2b98bDC0226Cc4C2A57BF52FC"',props:{style:{color:"var(--ch-8)"}}},{content:", ",props:{style:{color:"var(--ch-4)"}}},{content:"100",props:{style:{color:"var(--ch-2)"}}},{content:", ",props:{style:{color:"var(--ch-4)"}}},{content:"2",props:{style:{color:"var(--ch-2)"}}},{content:")",props:{style:{color:"var(--ch-4)"}}}]}],lang:"javascript"},annotations:[]}]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"This function should not be used without a max fee per gas. As you will have\nto pay the estimated price, even if it is higher than your budget."})}),"\n",(0,n.jsx)(t.h3,{id:"different-scenarios",children:"Different Scenarios"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Max Fee"}),(0,n.jsx)(t.th,{children:"Priority Fee"}),(0,n.jsx)(t.th,{children:"Comment"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.strong,{children:"undefined"})}),(0,n.jsx)(t.td,{children:"2"}),(0,n.jsxs)(t.td,{children:["Calculates the max fee by adding the provided priority fee with the estimated base fee. Note that the max fee will now be capped by ",(0,n.jsx)(t.code,{children:"baseFee + priorityFee"}),", which can consume all the provided priority fees."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"100"}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.strong,{children:"undefined"})}),(0,n.jsx)(t.td,{children:"Estimates the priority fee and uses the provided max fee. If the estimated priority fee is more than the provided max fee, then it throws an error."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.strong,{children:"undefined"})}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.strong,{children:"undefined"})}),(0,n.jsx)(t.td,{children:"It will estimate the base fee and priority fee from the network, and will add both the values to calculate the max fee per gas. Again, you have to pay whatever will be estimated."})]})]})]}),"\n",(0,n.jsx)(t.h2,{id:"re-issuing-a-stuck-transaction",children:"Re-issuing a Stuck Transaction"}),"\n",(0,n.jsx)(t.p,{children:"Sometimes during high network activity, some transactions can get stuck as pending for a long time,\ndue to relatively lower effective tip than the\nother transactions in the pool. We can either re-issue the same transaction with\na higher priority fee or cancel the transaction altogether. To re-issue the stuck\ntransaction, you can send a new transactiob with same amount and data but with higher\npriority fee and same nonce value as the stuck transaction. The transaction with\nlower effective tip will automatically be rejected (due to same nonce)."}),"\n",(0,n.jsx)(t.p,{children:"You can also cancel the stuck transaction, by sending a new transaction but\nkeeping the amount to 0, with a higher priority fee and same nonce. Let's say,\nthe above transaction with a nonce value of 25 has stuck. You can then re-issue\na new transaction with same nonce, but higher priority fee this time."}),"\n",(0,n.jsx)(a.Code,{codeConfig:l,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"// reissuing transaction with nonce 25",props:{style:{color:"var(--ch-1)"}}}]},{tokens:[{content:"sendDjtx",props:{style:{color:"var(--ch-5)"}}},{content:"(",props:{style:{color:"var(--ch-4)"}}},{content:'"0.01"',props:{style:{color:"var(--ch-8)"}}},{content:", ",props:{style:{color:"var(--ch-4)"}}},{content:'"0x8db97C7cEcE249c2b98bDC0226Cc4C2A57BF52FC"',props:{style:{color:"var(--ch-8)"}}},{content:", ",props:{style:{color:"var(--ch-4)"}}},{content:"100",props:{style:{color:"var(--ch-2)"}}},{content:", ",props:{style:{color:"var(--ch-4)"}}},{content:"10",props:{style:{color:"var(--ch-2)"}}},{content:", ",props:{style:{color:"var(--ch-4)"}}},{content:"25",props:{style:{color:"var(--ch-2)"}}},{content:")",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"",props:{style:{color:"var(--ch-4)"}}}]},{tokens:[{content:"// cancelling transaction with nonce 25",props:{style:{color:"var(--ch-1)"}}}]},{tokens:[{content:"sendDjtx",props:{style:{color:"var(--ch-5)"}}},{content:"(",props:{style:{color:"var(--ch-4)"}}},{content:'"0"',props:{style:{color:"var(--ch-8)"}}},{content:", ",props:{style:{color:"var(--ch-4)"}}},{content:'"0x8db97C7cEcE249c2b98bDC0226Cc4C2A57BF52FC"',props:{style:{color:"var(--ch-8)"}}},{content:", ",props:{style:{color:"var(--ch-4)"}}},{content:"100",props:{style:{color:"var(--ch-2)"}}},{content:", ",props:{style:{color:"var(--ch-4)"}}},{content:"10",props:{style:{color:"var(--ch-2)"}}},{content:", ",props:{style:{color:"var(--ch-4)"}}},{content:"25",props:{style:{color:"var(--ch-2)"}}},{content:")",props:{style:{color:"var(--ch-4)"}}}]}],lang:"javascript"},annotations:[]}]}),"\n",(0,n.jsx)(t.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,n.jsx)(t.p,{children:"You have learned about creating, signing, and sending transactions with dynamic\nfee parameters to the Utility Chain of Dijets network using JavaScript. It also\nexplained, how to re-issue or cancel a stuck transaction, by sending a\ntransaction with the same nonce. This tutorial points out the recommended way\nfor choosing max fee cap and max priority fee cap for transactions and can also\nwork as a general guide for all the EVM-based chains."})]})}function v(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.jsx)(h,Object.assign({},e,{children:(0,n.jsx)(d,e)}))}}},function(e){e.O(0,[2331,2499,9774,2888,179],(function(){return t=23703,e(e.s=t);var t}));var t=e.O();_N_E=t}]);